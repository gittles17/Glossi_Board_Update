<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Glossi</title>
  <meta name="theme-color" content="#0a0d12">
  <link rel="icon" type="image/svg+xml" href="Asset 3.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=Instrument+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="dashboard.css">
</head>
<body>
  <!-- Top Navigation -->
  <header class="top-nav">
    <div class="nav-left">
      <img src="Asset 3.svg" alt="Glossi" class="logo-img">
    </div>
    <div class="nav-right">
      <!-- Hamburger Menu -->
      <div class="menu-container">
        <button class="btn-icon" id="menu-btn" title="Menu">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>
        <div class="dropdown-menu" id="dropdown-menu">
          <button class="dropdown-item" id="menu-share">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
              <polyline points="16 6 12 2 8 6"></polyline>
              <line x1="12" y1="2" x2="12" y2="15"></line>
            </svg>
            Share
          </button>
          <button class="dropdown-item" id="menu-settings">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
            </svg>
            Settings
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Seed Raise Funnel Section -->
  <section class="seed-raise-section">
    <div class="seed-raise-header">
      <h2>Seed Raise</h2>
      <div class="seed-raise-progress">
        <span class="raised" id="seed-raised">$0</span>
        <span class="progress-divider">/</span>
        <span class="target" id="seed-target">$500K</span>
        <div class="seed-progress-bar">
          <div class="seed-progress-fill" id="seed-progress-fill"></div>
        </div>
        <span class="progress-percent" id="seed-percent">0%</span>
      </div>
      <button class="add-btn-small" id="add-investor-btn" title="Add Investor">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
      </button>
    </div>
    
    <div class="funnel-kanban">
      <div class="funnel-column" data-stage="interested">
        <div class="column-header">
          <div class="column-header-left">
            <span class="column-title">Interested</span>
            <span class="column-count" id="count-interested">(0)</span>
          </div>
          <span class="column-total" id="total-interested"></span>
        </div>
        <div class="column-items" id="stage-interested">
          <!-- Investor cards rendered here -->
        </div>
      </div>
      <div class="funnel-column" data-stage="inTalks">
        <div class="column-header">
          <div class="column-header-left">
            <span class="column-title">In Talks</span>
            <span class="column-count" id="count-inTalks">(0)</span>
          </div>
          <span class="column-total" id="total-inTalks"></span>
        </div>
        <div class="column-items" id="stage-inTalks">
          <!-- Investor cards rendered here -->
        </div>
      </div>
      <div class="funnel-column" data-stage="committed">
        <div class="column-header">
          <div class="column-header-left">
            <span class="column-title">Committed</span>
            <span class="column-count" id="count-committed">(0)</span>
          </div>
          <span class="column-total" id="total-committed"></span>
        </div>
        <div class="column-items" id="stage-committed">
          <!-- Investor cards rendered here -->
        </div>
      </div>
      <div class="funnel-column" data-stage="closed">
        <div class="column-header">
          <div class="column-header-left">
            <span class="column-title">Closed</span>
            <span class="column-count" id="count-closed">(0)</span>
          </div>
          <span class="column-total" id="total-closed"></span>
        </div>
        <div class="column-items" id="stage-closed">
          <!-- Investor cards rendered here -->
        </div>
      </div>
    </div>
  </section>

  <!-- Pipeline Section -->
  <section class="pipeline-section">
    <div class="pipeline-header">
      <h2>Pipeline</h2>
      <div class="pipeline-progress">
        <span class="pipeline-total" id="pipeline-total-value">$0</span>
        <span class="progress-divider">/</span>
        <span class="pipeline-closed" id="pipeline-closed-value">$0</span>
        <span class="pipeline-closed-label">closed</span>
      </div>
      <select id="pipeline-week-select" class="time-filter">
        <option value="current">Current</option>
        <!-- Populated by JS with past weeks -->
      </select>
      <button class="add-btn-small" id="edit-pipeline-btn" title="Update Pipeline">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
      </button>
    </div>
    
    <!-- Pipeline Content Card (Week at a Glance style) -->
    <div class="pipeline-content-card">
      <div class="pipeline-columns">
        <!-- Left Column: Revenue by Stage & Key Updates -->
        <div class="pipeline-column-left">
          <!-- Revenue by Stage -->
          <div class="meeting-section" id="revenue-section">
            <div class="section-header-row">
              <div class="section-header-left">
                <h4>Revenue by Stage</h4>
              </div>
            </div>
            <div class="section-content">
              <div class="stage-list" id="pipeline-stage-list">
                <!-- Populated by JS -->
              </div>
            </div>
          </div>

          <!-- Key Updates -->
          <div class="meeting-section" id="updates-section">
            <div class="section-header-row">
              <div class="section-header-left">
                <h4>Key Updates</h4>
                <span class="item-count" id="updates-count"></span>
              </div>
            </div>
            <div class="section-content">
              <ul class="updates-list" id="pipeline-updates-list">
                <li class="empty-state">No updates yet.</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Right Column: Closest to Close & Marketing -->
        <div class="pipeline-column-right">
          <!-- Closest to Close -->
          <div class="meeting-section" id="close-section">
            <div class="section-header-row">
              <div class="section-header-left">
                <h4>Closest to Close</h4>
                <span class="item-count" id="close-count"></span>
              </div>
            </div>
            <div class="section-content">
              <ul class="close-list" id="pipeline-close-list">
                <li class="empty-state">No deals in late stages.</li>
              </ul>
            </div>
          </div>

          <!-- Marketing -->
          <div class="meeting-section" id="marketing-section">
            <div class="section-header-row">
              <div class="section-header-left">
                <h4>Marketing</h4>
                <span class="item-count" id="marketing-count"></span>
              </div>
            </div>
            <div class="section-content">
              <ul class="marketing-list" id="pipeline-marketing-list">
                <li class="empty-state">No marketing updates.</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Dashboard Container -->
  <main class="dashboard-container">
    <!-- Left Panel: Meeting Minutes (Last Week at a Glance) -->
    <section class="panel panel-left">
      <div class="panel-header">
        <h2>Week at a Glance</h2>
        <div class="header-controls">
          <select id="meeting-select" class="time-filter">
            <option value="latest">This Week</option>
            <!-- Populated by JS with past weeks -->
          </select>
          <button class="btn btn-icon btn-secondary" id="add-notes-btn" title="Add Notes">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
          </button>
        </div>
      </div>

      <div class="panel-content">
        <!-- Current Meeting Summary -->
        <div class="meeting-card" id="current-meeting">
          <div class="meeting-columns">
            <!-- Left Column: Summary & Decisions -->
            <div class="meeting-column-left">
              <!-- Summary Section -->
              <div class="meeting-section collapsible" id="summary-section">
                <div class="section-header-row clickable" data-toggle="summary-content">
                  <div class="section-header-left">
                    <button class="collapse-toggle" aria-expanded="true">
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <h4>Summary</h4>
                    <span class="item-count" id="summary-count"></span>
                  </div>
                  <button class="add-btn-small" id="add-summary-btn" title="Add summary point">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </button>
                </div>
                <div class="section-content" id="summary-content">
                  <ul class="summary-list" id="meeting-summary">
                    <li class="empty-state">No meeting notes yet. Click + to add notes.</li>
                  </ul>
                </div>
              </div>

              <!-- Key Decisions -->
              <div class="meeting-section collapsible" id="decisions-section">
                <div class="section-header-row clickable" data-toggle="decisions-content">
                  <div class="section-header-left">
                    <button class="collapse-toggle" aria-expanded="true">
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <h4>Key Decisions</h4>
                    <span class="item-count" id="decisions-count"></span>
                  </div>
                  <button class="add-btn-small" id="add-decision-btn" title="Add decision">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                  </button>
                </div>
                <div class="section-content" id="decisions-content">
                  <ul class="decisions-list" id="decisions-list">
                    <li class="empty-state">No decisions recorded.</li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- Right Column: Action Items -->
            <div class="meeting-column-right">
              <!-- Action Items -->
              <div class="meeting-section collapsible" id="actions-section">
                <div class="section-header-row clickable" data-toggle="actions-content">
                  <div class="section-header-left">
                    <button class="collapse-toggle" aria-expanded="true">
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                    <h4>Action Items</h4>
                  </div>
                  <div class="section-header-right">
                    <button class="add-btn-small" id="add-todo-btn" title="Add action item">
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                      </svg>
                    </button>
                    <span class="meeting-status" id="meeting-status">
                      <span id="todo-progress">0/0 complete</span>
                    </span>
                  </div>
                </div>
                <div class="section-content" id="actions-content">
                  <div class="action-progress-bar" id="action-progress-bar">
                    <div class="action-progress-fill" id="action-progress-fill"></div>
                  </div>
                  <div class="todo-list" id="todo-list">
                    <div class="empty-state">No action items yet.</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- Right Panel: Cheat Sheet Summary -->
    <section class="panel panel-right">
      <div class="panel-header">
        <h2>Knowledge Base</h2>
      </div>
      
      <div class="panel-content" id="cheatsheet-panel">
        <!-- Knowledge Base -->
        <div class="knowledge-base" id="knowledge-base">
          <!-- Sources Sidebar (Collapsible) -->
          <div class="kb-sources-sidebar" id="kb-sources-sidebar">
            <div class="kb-sources-header">
              <button class="kb-toggle-sidebar" id="kb-toggle-sidebar" title="Toggle Sources">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                </svg>
              </button>
              <span class="kb-sources-title">Sources</span>
              <span class="kb-sources-count" id="kb-sources-count">0</span>
            </div>
            <div class="kb-sources-list" id="kb-sources-list">
              <!-- Sources rendered dynamically -->
              <div class="kb-empty-sources">
                <p>No sources yet</p>
                <p class="kb-empty-hint">Add documents, URLs, or paste text</p>
              </div>
            </div>
            <button class="kb-add-source-btn" id="kb-add-source-btn" title="Add Source">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              <span>Add Source</span>
            </button>
          </div>

          <!-- Main Workspace -->
          <div class="kb-workspace" id="kb-workspace">
            <!-- Quick Actions Bar -->
            <div class="kb-quick-actions" id="kb-quick-actions">
              <button class="kb-action-btn" data-action="summarize" title="Summarize all sources">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="21" y1="10" x2="3" y2="10"></line>
                  <line x1="21" y1="6" x2="3" y2="6"></line>
                  <line x1="21" y1="14" x2="3" y2="14"></line>
                  <line x1="21" y1="18" x2="3" y2="18"></line>
                </svg>
                <span>Summarize</span>
              </button>
              <button class="kb-action-btn" data-action="quotes" title="Extract key quotes">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V21z"></path>
                  <path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3z"></path>
                </svg>
                <span>Key Quotes</span>
              </button>
              <button class="kb-action-btn" data-action="changes" title="What's changed recently">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span>Recent Changes</span>
              </button>
              <button class="kb-action-btn kb-action-generate" data-action="generate" title="Generate report">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                </svg>
                <span>Generate Report</span>
              </button>
            </div>

            <!-- Chat/Conversation Area -->
            <div class="kb-chat-area" id="kb-chat-area">
              <div class="kb-messages" id="kb-messages">
                <!-- Welcome message -->
                <div class="kb-message kb-message-system">
                  <div class="kb-message-content">
                    <p><strong>Welcome to your Knowledge Base</strong></p>
                    <p>Add sources (documents, URLs, text) and I'll help you analyze them, answer questions, and generate reports.</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Chat Input -->
            <div class="kb-input-area" id="kb-input-area">
              <div class="kb-input-wrapper">
                <textarea id="kb-chat-input" class="kb-chat-input" placeholder="Ask a question about your sources..." rows="1"></textarea>
                <button class="kb-send-btn" id="kb-send-btn" title="Send">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <!-- Reports Panel (Collapsible) -->
          <div class="kb-reports-panel" id="kb-reports-panel">
            <div class="kb-reports-header">
              <button class="kb-toggle-reports" id="kb-toggle-reports" title="Toggle Reports">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                </svg>
              </button>
              <span class="kb-reports-title">Reports</span>
              <span class="kb-reports-count" id="kb-reports-count">0</span>
            </div>
            <div class="kb-reports-list" id="kb-reports-list">
              <!-- Reports rendered dynamically -->
              <div class="kb-empty-reports">
                <p>No reports yet</p>
                <p class="kb-empty-hint">Generate reports from your sources</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Review Modal -->
  <div class="modal-overlay" id="review-modal">
    <div class="modal">
      <div class="modal-header">
        <h2>Review Suggested Changes</h2>
        <button class="btn-icon modal-close" id="modal-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body" id="review-content">
        <!-- Populated by JS with AI suggestions -->
        <div class="review-loading">
          <div class="spinner"></div>
          <p>Claude Opus is analyzing your content...</p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="review-reject">Reject All</button>
        <button class="btn btn-primary" id="review-accept">Accept Changes</button>
      </div>
    </div>
  </div>

  <!-- Meeting Notes Modal -->
  <div class="modal-overlay" id="notes-modal">
    <div class="modal modal-large">
      <div class="modal-header">
        <h2>Add Meeting Notes</h2>
        <button class="btn-icon modal-close" id="notes-modal-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="notes-input-section">
          <label for="meeting-title">Meeting Title</label>
          <input type="text" id="meeting-title" placeholder="Weekly Board Sync" class="input">
        </div>
        <div class="notes-input-section">
          <label for="meeting-date-input">Date</label>
          <input type="date" id="meeting-date-input" class="input">
        </div>
        <div class="notes-input-section">
          <label for="meeting-notes-input">Meeting Notes</label>
          <textarea id="meeting-notes-input" class="input textarea" placeholder="Paste your meeting notes here. Claude Opus will analyze them and extract:
- Key summary points
- Action items with owners
- Important decisions made
- Updates to pipeline or talking points"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="notes-cancel">Cancel</button>
        <button class="btn btn-secondary" id="notes-save-direct">Save as Notes</button>
        <button class="btn btn-primary" id="notes-process">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
          </svg>
          Process with AI
        </button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal-overlay" id="settings-modal">
    <div class="modal modal-large">
      <div class="modal-header">
        <h2>Settings</h2>
        <button class="btn-icon modal-close" id="settings-modal-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="settings-section">
          <h3>Claude API Configuration</h3>
          <p class="settings-description">Enter your Anthropic API key to enable AI-powered features.</p>
          <div class="input-group">
            <label for="api-key">Anthropic API Key</label>
            <input type="password" id="api-key" class="input" placeholder="sk-ant-...">
            <button class="btn btn-secondary btn-sm" id="toggle-api-key">Show</button>
          </div>
          <div class="api-status" id="api-status">
            <span class="status-indicator"></span>
            <span class="status-text">Not configured</span>
          </div>
        </div>
        <div class="settings-section">
          <h3>Audio Transcription (OpenAI)</h3>
          <p class="settings-description">Enter your OpenAI API key for Whisper audio transcription.</p>
          <div class="input-group">
            <label for="openai-api-key">OpenAI API Key</label>
            <input type="password" id="openai-api-key" class="input" placeholder="sk-proj-...">
            <button class="btn btn-secondary btn-sm" id="toggle-openai-key">Show</button>
          </div>
          <div class="api-status" id="openai-status">
            <span class="status-indicator"></span>
            <span class="status-text">Not configured</span>
          </div>
        </div>
        <div class="settings-section">
          <h3>Seed Raise</h3>
          <p class="settings-description">Set your fundraising target for the seed raise tracker.</p>
          <div class="input-group input-group-inline">
            <label for="seed-raise-target">Target Amount</label>
            <input type="text" id="seed-raise-target" class="input input-sm" placeholder="e.g., $500K" value="$500K">
          </div>
        </div>
        <div class="settings-section">
          <h3>Data Storage</h3>
          <p class="settings-description">Your data is stored locally in JSON files.</p>
          <div class="storage-actions">
            <button class="btn btn-secondary" id="export-data">Export All Data</button>
          </div>
        </div>

        <div class="settings-section email-settings">
          <h3>Investor Email Format</h3>
          <p class="settings-description">Customize which sections appear in your weekly investor update emails.</p>
          
          <p class="settings-sublabel">Drag to reorder sections</p>
          <div class="email-sections-sortable" id="email-sections-sortable">
            <div class="sortable-item" data-section="metrics" draggable="true">
              <span class="drag-handle">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <circle cx="9" cy="6" r="2"></circle>
                  <circle cx="15" cy="6" r="2"></circle>
                  <circle cx="9" cy="12" r="2"></circle>
                  <circle cx="15" cy="12" r="2"></circle>
                  <circle cx="9" cy="18" r="2"></circle>
                  <circle cx="15" cy="18" r="2"></circle>
                </svg>
              </span>
              <label class="toggle-row">
                <input type="checkbox" id="email-metrics" checked>
                <span class="toggle-switch"></span>
                <span class="toggle-label">Key Metrics</span>
              </label>
            </div>
            <div class="sortable-item" data-section="pipeline" draggable="true">
              <span class="drag-handle">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <circle cx="9" cy="6" r="2"></circle>
                  <circle cx="15" cy="6" r="2"></circle>
                  <circle cx="9" cy="12" r="2"></circle>
                  <circle cx="15" cy="12" r="2"></circle>
                  <circle cx="9" cy="18" r="2"></circle>
                  <circle cx="15" cy="18" r="2"></circle>
                </svg>
              </span>
              <label class="toggle-row">
                <input type="checkbox" id="email-pipeline" checked>
                <span class="toggle-switch"></span>
                <span class="toggle-label">Pipeline Hot</span>
              </label>
            </div>
            <div class="sortable-item" data-section="talkingPoints" draggable="true">
              <span class="drag-handle">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <circle cx="9" cy="6" r="2"></circle>
                  <circle cx="15" cy="6" r="2"></circle>
                  <circle cx="9" cy="12" r="2"></circle>
                  <circle cx="15" cy="12" r="2"></circle>
                  <circle cx="9" cy="18" r="2"></circle>
                  <circle cx="15" cy="18" r="2"></circle>
                </svg>
              </span>
              <label class="toggle-row">
                <input type="checkbox" id="email-talking-points" checked>
                <span class="toggle-switch"></span>
                <span class="toggle-label">Key Talking Points</span>
              </label>
            </div>
            <div class="sortable-item" data-section="highlights" draggable="true">
              <span class="drag-handle">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <circle cx="9" cy="6" r="2"></circle>
                  <circle cx="15" cy="6" r="2"></circle>
                  <circle cx="9" cy="12" r="2"></circle>
                  <circle cx="15" cy="12" r="2"></circle>
                  <circle cx="9" cy="18" r="2"></circle>
                  <circle cx="15" cy="18" r="2"></circle>
                </svg>
              </span>
              <label class="toggle-row">
                <input type="checkbox" id="email-highlights" checked>
                <span class="toggle-switch"></span>
                <span class="toggle-label">This Week's Highlights</span>
              </label>
            </div>
            <div class="sortable-item" data-section="decisions" draggable="true">
              <span class="drag-handle">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <circle cx="9" cy="6" r="2"></circle>
                  <circle cx="15" cy="6" r="2"></circle>
                  <circle cx="9" cy="12" r="2"></circle>
                  <circle cx="15" cy="12" r="2"></circle>
                  <circle cx="9" cy="18" r="2"></circle>
                  <circle cx="15" cy="18" r="2"></circle>
                </svg>
              </span>
              <label class="toggle-row">
                <input type="checkbox" id="email-decisions" checked>
                <span class="toggle-switch"></span>
                <span class="toggle-label">Key Decisions</span>
              </label>
            </div>
            <div class="sortable-item" data-section="actionItems" draggable="true">
              <span class="drag-handle">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <circle cx="9" cy="6" r="2"></circle>
                  <circle cx="15" cy="6" r="2"></circle>
                  <circle cx="9" cy="12" r="2"></circle>
                  <circle cx="15" cy="12" r="2"></circle>
                  <circle cx="9" cy="18" r="2"></circle>
                  <circle cx="15" cy="18" r="2"></circle>
                </svg>
              </span>
              <label class="toggle-row">
                <input type="checkbox" id="email-action-items" checked>
                <span class="toggle-switch"></span>
                <span class="toggle-label">Action Items</span>
              </label>
            </div>
          </div>

          <div class="email-counts">
            <div class="input-group input-group-inline">
              <label for="email-pipeline-count">Pipeline deals to show</label>
              <input type="number" id="email-pipeline-count" class="input input-sm" min="1" max="10" value="5">
            </div>
            <div class="input-group input-group-inline">
              <label for="email-talking-points-count">Talking points to show</label>
              <input type="number" id="email-talking-points-count" class="input input-sm" min="1" max="10" value="4">
            </div>
          </div>

          <div class="email-signature">
            <div class="input-group">
              <label for="email-signature">Signature</label>
              <input type="text" id="email-signature" class="input" placeholder="JG" value="JG">
            </div>
            <div class="input-group">
              <label for="email-greeting">Custom greeting (optional)</label>
              <input type="text" id="email-greeting" class="input" placeholder="e.g., Hope you had a great week!">
            </div>
          </div>

          <div class="email-links">
            <p class="settings-sublabel">Footer Links</p>
            <div id="email-links-toggles">
              <!-- Link toggles rendered dynamically -->
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="settings-save">Save Settings</button>
      </div>
    </div>
  </div>


  <!-- Decision Modal -->
  <div class="modal-overlay" id="decision-modal">
    <div class="modal">
      <div class="modal-header">
        <h2>Add Decision</h2>
        <button class="btn-icon modal-close" id="decision-modal-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="notes-input-section">
          <label for="decision-text">Decision</label>
          <input type="text" id="decision-text" placeholder="e.g., Approved Q2 marketing budget" class="input">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="decision-cancel">Cancel</button>
        <button class="btn btn-primary" id="decision-save">Add</button>
      </div>
    </div>
  </div>


  <!-- Link Modal -->
  <div class="modal-overlay" id="link-modal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="link-modal-title">Add Link</h2>
        <button class="btn-icon modal-close" id="link-modal-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="notes-input-section">
          <label for="link-name">Display Name</label>
          <input type="text" id="link-name" placeholder="e.g., Product Demo" class="input">
        </div>
        <div class="notes-input-section">
          <label for="link-url">URL</label>
          <input type="url" id="link-url" placeholder="https://..." class="input">
        </div>
        <div class="notes-input-section">
          <label for="link-email-label">Email Label (optional)</label>
          <input type="text" id="link-email-label" placeholder="Label shown in emails" class="input">
        </div>
        <div class="notes-input-section">
          <label>Color</label>
          <div class="color-picker">
            <button type="button" class="color-option default selected" data-color="default"></button>
            <button type="button" class="color-option red" data-color="red"></button>
            <button type="button" class="color-option blue" data-color="blue"></button>
            <button type="button" class="color-option purple" data-color="purple"></button>
            <button type="button" class="color-option green" data-color="green"></button>
            <button type="button" class="color-option orange" data-color="orange"></button>
          </div>
        </div>
        <div class="notes-input-section">
          <label class="toggle-row">
            <input type="checkbox" id="link-email-enabled" checked>
            <span class="toggle-switch"></span>
            <span class="toggle-label">Include in investor emails</span>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-danger" id="link-delete" style="margin-right: auto; display: none;">Delete</button>
        <button class="btn btn-secondary" id="link-cancel">Cancel</button>
        <button class="btn btn-primary" id="link-save">Save</button>
      </div>
    </div>
  </div>

  <!-- Investor Modal -->
  <div class="modal-overlay" id="investor-modal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="investor-modal-title">Add Investor</h2>
        <button class="btn-icon modal-close" id="investor-modal-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="notes-input-section">
          <label for="investor-name">Investor Name</label>
          <input type="text" id="investor-name" placeholder="e.g., John Smith or Acme Ventures" class="input">
        </div>
        <div class="notes-input-section">
          <label for="investor-amount">Amount</label>
          <input type="text" id="investor-amount" placeholder="e.g., $50K" class="input">
        </div>
        <div class="notes-input-section">
          <label for="investor-stage">Stage</label>
          <select id="investor-stage" class="input">
            <option value="interested">Interested</option>
            <option value="inTalks">In Talks</option>
            <option value="committed">Committed</option>
            <option value="closed">Closed</option>
          </select>
        </div>
        <div class="notes-input-section">
          <label for="investor-notes">Notes (optional)</label>
          <textarea id="investor-notes" class="input textarea" rows="2" placeholder="Any additional context..."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-danger" id="investor-delete" style="margin-right: auto; display: none;">Delete</button>
        <button class="btn btn-secondary" id="investor-cancel">Cancel</button>
        <button class="btn btn-primary" id="investor-save">Save</button>
      </div>
    </div>
  </div>

  <!-- Unified Content Intelligence Modal -->
  <div class="modal-overlay" id="content-action-modal">
    <div class="modal modal-large">
      <div class="modal-header">
        <h2 id="unified-modal-title">Content Analysis</h2>
        <button class="btn-icon modal-close" id="content-action-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body unified-preview-body">
        <div class="content-analysis-result" id="content-analysis-result">
          <!-- Analysis result / loading state rendered here -->
        </div>
        <div class="unified-preview-sections" id="unified-preview-sections" style="display: none;">
          <!-- Dynamically populated with extracted data sections -->
        </div>
      </div>
      <div class="modal-footer unified-preview-footer" id="unified-preview-footer" style="display: none;">
        <button class="btn btn-secondary" id="unified-cancel">Cancel</button>
        <button class="btn btn-primary" id="unified-apply-selected">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          Apply Selected
        </button>
      </div>
    </div>
  </div>


  <!-- Add Source Modal -->
  <div class="modal-overlay" id="kb-source-modal">
    <div class="modal modal-large">
      <div class="modal-header">
        <h2>Add Source</h2>
        <button class="btn-icon modal-close" id="kb-source-modal-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <!-- Source Type Tabs -->
        <div class="kb-source-tabs">
          <button class="kb-source-tab active" data-type="text">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
            </svg>
            Paste Text
          </button>
          <button class="kb-source-tab" data-type="url">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
              <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
            </svg>
            URL
          </button>
        </div>

        <!-- Text Input Panel -->
        <div class="kb-source-panel active" id="kb-panel-text">
          <div class="notes-input-section">
            <label for="kb-source-title">Title (optional)</label>
            <input type="text" id="kb-source-title" class="input" placeholder="e.g., Q4 Customer Feedback">
          </div>
          <div class="notes-input-section">
            <label for="kb-source-text">Content</label>
            <textarea id="kb-source-text" class="input textarea" rows="10" placeholder="Paste your text content here..."></textarea>
          </div>
        </div>

        <!-- URL Input Panel -->
        <div class="kb-source-panel" id="kb-panel-url">
          <div class="notes-input-section">
            <label for="kb-source-url">URL</label>
            <input type="url" id="kb-source-url" class="input" placeholder="https://...">
          </div>
          <p class="kb-url-hint">The content will be fetched and analyzed automatically.</p>
        </div>

        <!-- Category Selection -->
        <div class="kb-category-section">
          <label>Category</label>
          <div class="kb-category-options" id="kb-category-options">
            <button class="kb-category-btn active" data-category="auto">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
              </svg>
              Auto-detect
            </button>
            <button class="kb-category-btn" data-category="market">Market Research</button>
            <button class="kb-category-btn" data-category="customer">Customer Feedback</button>
            <button class="kb-category-btn" data-category="competitor">Competitor Intel</button>
            <button class="kb-category-btn" data-category="product">Product Notes</button>
            <button class="kb-category-btn" data-category="other">Other</button>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="kb-source-cancel">Cancel</button>
        <button class="btn btn-primary" id="kb-source-save">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Add Source
        </button>
      </div>
    </div>
  </div>

  <!-- Generate Report Modal -->
  <div class="modal-overlay" id="kb-report-modal">
    <div class="modal modal-large">
      <div class="modal-header">
        <h2>Generate Report</h2>
        <button class="btn-icon modal-close" id="kb-report-modal-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <!-- Report Templates -->
        <div class="kb-report-templates">
          <label>Choose a template or describe what you need:</label>
          <div class="kb-template-options">
            <button class="kb-template-btn" data-template="investor_update">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="3" y1="9" x2="21" y2="9"></line>
                <line x1="9" y1="21" x2="9" y2="9"></line>
              </svg>
              <span>Investor Update</span>
              <small>Weekly/monthly progress summary</small>
            </button>
            <button class="kb-template-btn" data-template="talking_points">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="8" y1="6" x2="21" y2="6"></line>
                <line x1="8" y1="12" x2="21" y2="12"></line>
                <line x1="8" y1="18" x2="21" y2="18"></line>
                <line x1="3" y1="6" x2="3.01" y2="6"></line>
                <line x1="3" y1="12" x2="3.01" y2="12"></line>
                <line x1="3" y1="18" x2="3.01" y2="18"></line>
              </svg>
              <span>Talking Points</span>
              <small>Key points for investor calls</small>
            </button>
            <button class="kb-template-btn" data-template="due_diligence">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
              </svg>
              <span>Due Diligence Brief</span>
              <small>Comprehensive company overview</small>
            </button>
            <button class="kb-template-btn active" data-template="custom">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
              </svg>
              <span>Custom Report</span>
              <small>Describe what you need</small>
            </button>
          </div>
        </div>

        <!-- Custom Prompt -->
        <div class="notes-input-section">
          <label for="kb-report-prompt">What do you want to generate?</label>
          <textarea id="kb-report-prompt" class="input textarea" rows="4" placeholder="e.g., Create a summary of our competitive advantages based on customer feedback and market research..."></textarea>
        </div>

        <!-- Source Selection -->
        <div class="kb-source-selection">
          <label>Include sources:</label>
          <div class="kb-source-checkboxes" id="kb-report-sources">
            <!-- Populated dynamically -->
            <p class="kb-no-sources">Add sources first to generate reports</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="kb-report-cancel">Cancel</button>
        <button class="btn btn-primary" id="kb-report-generate">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
          </svg>
          Generate
        </button>
      </div>
    </div>
  </div>

  <!-- Pipeline Edit Modal -->
  <div class="modal-overlay" id="pipeline-edit-modal">
    <div class="modal modal-large">
      <div class="modal-header">
        <h2>Update Pipeline</h2>
        <button class="btn-icon modal-close" id="pipeline-edit-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <p class="modal-description">Paste your weekly pipeline email below. The content will be displayed as-is.</p>
        <div class="notes-input-section">
          <label for="pipeline-email-content">Pipeline Email Content</label>
          <textarea id="pipeline-email-content" class="input textarea" rows="15" placeholder="Paste your weekly pipeline email here..."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="pipeline-edit-cancel">Cancel</button>
        <button class="btn btn-primary" id="pipeline-edit-save">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          Save Pipeline
        </button>
      </div>
    </div>
  </div>

  <!-- Share Email Modal -->
  <div class="modal-overlay" id="share-email-modal">
    <div class="modal">
      <div class="modal-header">
        <h2>Generate Weekly Email</h2>
        <button class="btn-icon modal-close" id="share-email-close">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <p class="modal-description">Select sections to include in your weekly update email.</p>
        
        <div class="share-sections">
          <label class="checkbox-item">
            <input type="checkbox" id="share-pipeline" checked>
            <span class="checkbox-label">Pipeline Summary</span>
            <span class="checkbox-hint">Totals, stage breakdown, hot deals</span>
          </label>
          
          <label class="checkbox-item">
            <input type="checkbox" id="share-seedraise" checked>
            <span class="checkbox-label">Seed Raise Progress</span>
            <span class="checkbox-hint">Amount raised, recent commits</span>
          </label>
          
          <label class="checkbox-item">
            <input type="checkbox" id="share-meetings" checked>
            <span class="checkbox-label">Week at a Glance</span>
            <span class="checkbox-hint">Summary, decisions, action items</span>
          </label>
          
          <label class="checkbox-item">
            <input type="checkbox" id="share-reports">
            <span class="checkbox-label">Knowledge Base Reports</span>
            <span class="checkbox-hint" id="share-reports-hint">No reports generated</span>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="share-email-cancel">Cancel</button>
        <button class="btn btn-primary" id="share-email-generate">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 2L11 13"></path>
            <path d="M22 2l-7 20-4-9-9-4 20-7z"></path>
          </svg>
          Generate Email
        </button>
      </div>
    </div>
  </div>

  <!-- Progress Overlay -->
  <div class="progress-overlay" id="progress-overlay">
    <div class="progress-card">
      <div class="progress-title" id="progress-title">Processing Audio</div>
      <div class="progress-status" id="progress-status">Uploading...</div>
      <div class="progress-bar-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      <div class="progress-percent" id="progress-percent">0%</div>
    </div>
  </div>


  <!-- Toast Notifications -->
  <div class="toast-container" id="toast-container"></div>

  <!-- PDF Export Template (hidden) -->
  <div id="pdf-template" style="display: none;"></div>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script>
    // Set PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
  </script>
  <script type="module" src="app.js"></script>
</body>
</html>
